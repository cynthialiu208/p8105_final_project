---
title: "Data Initialization"
author: "Cynthia Liu (cl3938)"
date: "11/18/2020"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(readxl)
library(readr)

knitr::opts_chunk$set(
	fig.width = 9, 
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

Clean data:

  * Clean names
  * Select relevant predictors & outcomes (demographics, SES, health outcomes, insurance status, number of providers)
  * Drop neighborhoods that have no residential population (i.e. LaGuardia airport)
  * Drop observation representing NYC aggregated
  * Remove variables corresponding to 95% CI and reliability metrics of measurements
  * Create new variable representing aggregated clinic and community health centers
  
```{r}
project_df = read_excel("./data/nta-metadata.xlsx", sheet = "NTA Data") %>%
  janitor::clean_names() %>%
  select(nta_name:female, hispanic:limited_eng,edu_less_than_hs:poverty,unemployment,preterm_births:smm_reliability, gonorrhea, health_ins, medicaid_enroll, late_no_prenatal_care, clinics, community_health_centers, non_pcmd, -contains("95cl"), -contains("reliability")) %>%
  mutate(clinics_and_chc_count = clinics + community_health_centers) %>%
  drop_na(total_pop) %>%
  filter(nta_code != 'NYC')

write.csv(project_df, 'data/final_regression_variables_clean.csv', row.names = FALSE)
  
```




